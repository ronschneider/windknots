{{ define "main" }}
<article class="max-w-4xl mx-auto px-4 py-8">
  <!-- Hero Image -->
  {{ if .Params.image }}
  <div class="mb-8 -mx-4 md:mx-0 md:rounded-xl overflow-hidden shadow-lg">
    <img src="{{ .Params.image }}" alt="{{ .Title }}" class="w-full h-64 md:h-96 object-cover">
  </div>
  {{ end }}

  <!-- Header -->
  <header class="mb-8">
    <div class="flex items-center gap-2 text-sm text-gray-500 mb-4">
      <a href="/themes/" class="text-ocean-600 hover:underline">Daily Digest</a>
      <span>/</span>
      <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
    </div>

    <h1 class="text-4xl font-bold text-ocean-800 mb-4">{{ .Title }}</h1>

    <div class="flex flex-wrap gap-2 mb-6">
      {{ range .Params.tags }}
      <a href="/tags/{{ . | urlize }}/" class="px-3 py-1 bg-ocean-100 text-ocean-700 rounded-full text-sm hover:bg-ocean-200">
        {{ . }}
      </a>
      {{ end }}
    </div>
  </header>

  <!-- Editorial Content -->
  <div class="prose prose-lg max-w-none mb-12">
    {{ .Content }}
  </div>

  <!-- Related Articles -->
  <section class="border-t pt-8">
    <h2 class="text-2xl font-bold text-ocean-800 mb-6">Related Articles</h2>

    <div class="grid gap-6 md:grid-cols-2">
      {{ range .Params.related_articles }}
        {{ $articlePath := printf "articles/%s" . }}
        {{ $article := $.Site.GetPage $articlePath }}
        {{ if $article }}
        <a href="{{ $article.Permalink }}" class="block bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
          {{ if $article.Params.image }}
          <div class="h-40 bg-gray-200 overflow-hidden">
            <img src="{{ $article.Params.image }}" alt="{{ $article.Title }}"
                 class="w-full h-full object-cover">
          </div>
          {{ end }}
          <div class="p-4">
            <div class="text-xs text-gray-500 mb-1">{{ $article.Params.source_name }}</div>
            <h3 class="font-semibold text-ocean-700 mb-2 line-clamp-2">{{ $article.Title }}</h3>
            <p class="text-sm text-gray-600 line-clamp-2">{{ $article.Params.summary }}</p>
          </div>
        </a>
        {{ end }}
      {{ end }}
    </div>
  </section>

  <!-- Back to Roundups -->
  <div class="mt-12 pt-8 border-t">
    <a href="/themes/" class="text-ocean-600 hover:underline">&larr; All Daily Digests</a>
  </div>
</article>
{{ end }}
